# CHANGELOG

## v0.22.2 (2024-05-20)

- インストーラでバージョンチェックしないようにしてダウングレード可能にする (#163)

## v0.22.1 (2024-05-04)

- CONTRIBUTING.mdへのリンクをREADMEに追加 (#149)
- グローバル変数のうちMainActorでもてるものを分離 (#147)
- グローバル変数でもっていたローマ字かな変換ルールをMainActorからのみ触れるようにする (#150)
- 未使用変数やletにできるvarを修正 (#151)
- 送り仮名が未入力で変換すると空文字列を送り仮名として使用してしまうバグを修正 (#152)
- グローバル変数でもっていたユーザー辞書をMainActorからのみ触れるようにする (#153)
- ユーザー辞書の読み込み状態が設定画面に反映されないバグを修正 (#155)

## v0.22.0 (2024-04-28)

- ローカル開発用のbuild_restart.shとCONTRIBUTING.mdを設置 (#143)
- SKKServ辞書機能を設定可能にする (#145)
  - SKKServとの通信でエラーが発生したときは接続をリセットする (#146)

## v0.21.0 (2024-04-15)

- 変換候補パネルで状態がおかしいときにクラッシュさせないように修正 (#139)
- 変換開始はhandleComposingStartConvertをすべて使うようにリファクタ (#140)
- EUC-JISX0213の文字列の読み込みをDataから行うようにする (#141)
- 変換候補と注釈のフォントサイズ変更を追加 (#142)
- GitHub Actions環境をXcode 15.3に変更 (before 15.2) (#144)

## v0.20.0 (2024-03-10)

- ノーマル時のかなキーの動作をCtrl-Jと同じにする (#133)
- 送り仮名つきの辞書登録完了時に確定する文字列に送り仮名がついてなかったバグを修正 (#137)
- 空文字挿入の互換性を入力メニューから設定できる (#135)
- 存在型を利用している箇所にanyを追加 (#138)

## v0.19.0 (2024-03-03)

- KittyやLINEでq/lやC-jによるモード切り替えで文字が挿入される問題のワークアラウンド (#129)
  - Kitty用のワークアラウンドがAlacrittyにも有効だったので追加 (#132)
- Abbrevモードから抜けたときに入る前のモードに戻す (#128)
- SKK辞書を引く送り仮名のアルファベット表記をひらがなごとに定義 (#131)

## v0.18.2 (2024-02-26)

- `kanaRule`を`StateMachine`のコンストラクターに渡すのをやめる (#126)

## v0.18.1 (2024-02-26)

- GitHub ActionsのCIのパーミッションでForkからのPull Requestでchecks: writeを追加 (#121)
- ForkからのPull Requestでもxcresulttoolが実行できるようにpull_request_targetで発火するように修正 (#122)
- kana-rule.confでk;やkqのようなセミコロン/qを含むルールを許可 (#120)
  - tqのようなローマ字変換ルールがあるときにシフト押してないときにも未確定文字入力モードになるバグを修正 (#124)
- DeleteキーとCtrl-Dでカーソルより右の文字を削除 (#118)
  - MacでDelキーはFnキーを入力しながらじゃないと入力できない (#125)
- 入力元のウィンドウレベルより1大きいレベルでパネルを表示する (#123)

## v0.18.0 (2024-02-18)

- フルキーボードアクセスが有効時に変換候補パネルが一瞬で消える問題に対処 (#116)
- カーソルより右に文字列があるときに変換を確定すると未確定だった文字列を入力済扱いにする (#113)

## v0.17.2 (2024-02-12)

- GitHub Actions環境をmacOS 14 + Xcode 15.2に更新 (#111)
- ユーザー辞書で読み込み/書き込みエラーが起きたとき通知センターに通知する (#110)
- Abbrevモードでカーソル位置が末尾じゃないときにも末尾に入力されてしまうバグを修正 (#114)

## v0.17.1 (2024-02-04)

- 未確定文字列の末尾がnのときStickyShift入力で「ん」に確定させる (#109)

## v0.17.0 (2024-02-03)

- 変換候補選択時にxキーで前候補に戻れるようにする (#103)
- 変換候補の一覧表示を出すまでの変換候補送り回数を指定したい (#104)
  - インラインで表示する変換候補の数を設定できるようにする (#105)
  - 注釈非表示のとき変換候補の表示位置のY座標が上にずれるバグを修正 (#107)
- 環境設定の初期値が設定される前に読み込まれるバグを修正 (#106)

## v0.16.1 (2024-01-23)

- 直接入力モードでも英数・かなキーを無視してなかったのを修正 (#102)

## v0.16.0 (2024-01-21)

- ローマ字変換ルールを設定ファイル化 (#96)
- 独自のローマ字変換ルール設定ファイルを読み込むようにする (#98)
- 起動時に独自のローマ字変換ルールファイルがあっても使われないバグを修正 (#99)

## v0.15.1 (2024-01-13)

- ユーザー辞書を保存後に読み込み直していたバグを修正 (#86)
- Xcodeからデバッグ実行しているときはユーザー辞書の永続化をスキップする (#87)
- GitHub Actionsで利用するのをXcode 15.1に変更 (before 15.0.1) (#89)
- SKK辞書にUTF8-BOMがついている場合は除去する (#90)
- ユーザー辞書を読み込みエラー時はnilでもつようにする (#88)
- 英数・かなキーを打つとエディタに文字が入力されるバグを修正 (#94)
- 通知センターのメッセージのハンドリングで完了メソッドを呼んでなかったのを修正 (#95)

## v0.15.0 (2024-01-07)

- MemoryDictのコンストラクタでtryが不要になってたので除去 (#78)
- 数値変換エントリで変換候補の数値以外の数が読みの数値以外の数より少ないとき変換できないバグを修正 (#76)
- 未確定文字列の入力中、カーソルが先頭のときにスペースを押すと入力前に戻らないバグを修正 (#80)
- アプリのログを設定画面で見れるようにする (#81)
- iconvを使ってEUC-JISX0213を読めるようにする (#82)
- 振り仮名入力中にqを押すと入力文字列が消えるバグを修正 (#83)
- 設定画面でツールバーとボディが被ることがあるのを修正 (#84)
- 設定画面のサイドバーの横幅が小さくならないようにframeでwidthを設定 (#85)

## v0.14.0 (2023-12-29)

- 注釈を表示するかの設定項目を追加 (#74)

## v0.13.0 (2023-12-10)

- キー配列を設定から選択可能にした (#71)
- カーソル位置が未確定文字列の先頭のときバックスペースで末尾から削除されるバグを修正 (#72)
- インストール終了時に古いプロセスを終了する (#73)

## v0.12.1 (2023-12-03)

- ローマ字一文字だけ入力時、バックスペースで未入力に戻れなかったバグの修正 (#70)

## v0.12.0 (2023-11-26)

- 送り仮名エントリのブロック形式対応 (#69)

## v0.11.0 (2023-11-12)

- GitHub Actionsで利用するのをXcode 15.0.1に変更 (before 15.0) (#66)
- 数値変換の簡易な対応 (#55)
- 未確定のローマ字のみ入力時に右矢印やC-aやC-e入力でカーソルが移動しなくなるバグの修正 (#67)
- GitHub Actionsでのxcodebuildの出力をxcprettyに渡す & actions/checkoutのバージョンアップ (#68)

## v0.10.1 (2023-11-03)

- 未確定のローマ字が入力されたあとでC-gが呼ばれたら入力前状態に戻す (#63)
- 直接入力設定でアプリアイコンが読み込みしても更新されないバグを修正 + 設定画面の英訳されてない箇所を英訳 (#64)
- 未確定のローマ字のみ入力時に左矢印キーが入力されたら未入力状態に戻す (#65)

## v0.10.0 (2023-10-22)

- 接頭辞・接尾辞のエントリに対応 (#51)
- 直接入力モードのアプリで入力モードのホバー表示していたのを修正 (#52)
- macOS 14 Sonomaで発生する不具合への対応
  - テスト実行時にApp SandboxのData Containerにアクセスしている箇所を修正 (#53)
  - macOS 14 Sonomaで設定画面のサイドバー切り替えボタンを非表示にするAPIが使えるようになったので対応 (#56)
  - macOS 14 Sonomaで入力メニューから環境設定が開けなくなった問題の暫定対応 (#58)
  - macOS 14で設定を開いたときにキーウィンドウにしてフォーカスを当てる (#61)
  - 設定画面を入力メニューから表示するときにアクティブにする (#62)
- 設定画面のツールバーに戻る・進むボタンを追加 (#59)
- XcodeプロジェクトファイルにApple Team IDをセット (#60)

## v0.9.1 (2023-10-08)

- Dockにアイコンが表示されてしまうビルドになっているのを修正 (#48)
- シフトを押しながら記号を入力したときにシフトなしのときの記号が入力されるのを修正 (#47)
- Bundle Identifierをもたないアプリだと入力メニューでクラッシュするバグを修正 (#50)
  - ひとまずBundle Identifierをもたないアプリでは直接入力設定を無効化しました

## v0.9.0 (2023-09-30)

- Abbrevモードでカーソルを左にずらしていても変換時にカーソルが無視されるバグを修正 (#40)
- ユーザー辞書へ追加するとき元の辞書の注釈は保存しない (#41)
- ユーザー独自の注釈を表すアスタリスクつきの注釈に対応 (#42)
- C-qで半角カナにならないのを修正 (#44)
- GitHub Actionsで利用するのをXcode 15に変更 (before 14.3.1) (#45)
- タブキーで変換候補から補完できる (#43)
- Shift-Qで見出し語へ遷移するように修正 (#46)

## v0.8.0 (2023-09-18)

- アプリケーションの終了前にユーザー辞書を保存する処理を実装  (#32)
- プライベートモードをMemoryDictを使うようにリファクタ (#33)
- 変換パネルやインライン変換時の注釈をスクリーン右端をはみ出さない位置に表示するようにした (#34)
- 読みに非アルファベットを入力できるようにする (#35)
- ユーザー辞書の情報を辞書設定に表示する (#36)
- 辞書をシリアライズするときに送りありなしや使用順序を記録する (#38)
- macSKK外で辞書が更新されたときのイベントで読み込む (#39)

## v0.7.1 (2023-09-10)

- ファイル辞書が更新されたら読み直すなどのリファクタリング (#27)
- 直接入力の設定に説明を追加し一個も登録してないときには未登録と表示するようにした (#29)
- ユーザー辞書にマジックコメントを追加。単語削除時に保存する処理を入れてなかったのを修正 (#30)
- インライン注釈が表示されたあと次の候補が注釈がないときに空パネルが残るバグを修正 (#31)

## v0.7.0 (2023-09-02)

- アプリごとにIMEとして処理せずに直接入力するかどうかを設定できるようにした (#23)
- 自動更新チェックで見つかったリリース情報を通知するときに固定値にしていたバグを修正 (#24)
- インストーラの最初に表示される文章を追加 (#25)
- 送り仮名が `n` 一文字のときにスペース押したときは送り仮名を「ん」として扱うように修正 (#26)

## v0.6.0 (2023-08-27)

- 最低OSバージョンをmacOS 13.1から13.3に変更
- インライン変換候補選択時に注釈を表示する (#20)
- 複数辞書が同じエントリをもっているとき同じ変換候補が複数出るバグを修正 (#21)
- SKK-JISYO.LのインストールパスをSandboxコンテナのルートになっていたのを修正 (#22)

## v0.5.0 (2023-08-21)

- 新しいリリースがないかを定期的にチェックする (#17)
  - みつかった場合は通知センターに通知します。
  - 現状は設定なしでだいたい起動後12時間おきにチェックします。
- 設定の辞書設定からファイル辞書の優先順位をマウスで入れ替え可能にした (#18)
- Thingsのメモ欄などの入力用のワークアラウンドが壊れていたのを修正 (#19)

## v0.4.0 (2023-08-18)

- 未確定文字列の下線のスタイルを変換候補選択時以外は薄くする (#15)
- 未確定入力中にカーソル移動してから文字を打つと末尾に追加されるバグを修正 (#16)
- 変換候補選択からキャンセルしたときにカーソル移動できてしまうのを修正
- 循環参照によるメモリリークがまだ残っていたので修正
- Swift Concurrency CheckingをCompleteに変更

## v0.3.0 (2023-08-16)

- マイ辞書に一時的に保存しなくするプライベートモードを追加 (#12, #14)
- ローマ字の子音のあとにハイフンを打つと半角のハイフンが入力されるバグ修正 (#13)
- メモリリークを修正

## v0.2.1 (2023-08-14)

- 未決定のローマ字があるときに確定すると未確定文字列がエディタに残るバグを修正 (#8)
- abbrevモードで"q"を入力するとクラッシュするバグを修正 (#9)
- commitCompositionが呼ばれたときに未確定文字列を確定するように修正 (#10)
- インストーラ作成時にxcarchiveのexportArchiveから作成するように修正 (#11)

## v0.2.0 (2023-08-13)

- バージョンチェック機能を追加しました。設定のソフトウェアアップデートからチェックできます。(#5)
  - 現状は手動チェック機能のみです。今後定期的な更新チェック機能を入れる予定です。
- 複数の辞書ファイルを読み込めるようになりました (#6)
  - `~/Library/Containers/net.mtgto.inputmethod.macSKK/Data/Dictionaries` に配置して設定から有効にしてください
  - 現状はmacOSのSandboxで読み込みファイルを制限しているので、 `~/.skk-jisyo` 辞書をmacSKKで使用することはできません。
    - 将来skkservを辞書として追加できるようにするかもしれません。
- abbrevモードで"l"を入力するとクラッシュするバグを修正
- abbrevモードで"!"のようにシフトを押しながら入力するキーでも"1"になってしまうバグを修正 (#7)

## v0.1.1 (2023-08-09)

- 内蔵の辞書で国語辞書を優先して使用するように修正 (#3)
- 変換候補の注釈の表示が離れたところに表示されてしまうことがあるのを修正 (#4)
- テキスト入力部がスクリーン下部の場合に変換候補が見切れていたのを修正

## v0.1.0 (2023-08-07)

- 最初のリリース
